# ğŸ“š OpenCode/OpenClaw å®Œæ•´è¦ç¯„æ¡†æ¶

> **è³‡æ–™ä¾†æº**ï¼š3x3 æ‰¹æ¬¡æœå°‹ + 5 å›è¨è«–æ•´ç†
> **å‘é‡æª¢ç´¢æ¨™ç±¤**ï¼š`framework`, `specification`, `parameters`, `best-practices`, `è¦ç¯„`, `æ¡†æ¶`

---

## ğŸ“‹ æ¡†æ¶ç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                OpenCode/OpenClaw å®Œæ•´è¦ç¯„æ¡†æ¶                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   OpenCode   â”‚  â”‚   OpenClaw   â”‚  â”‚  è¼ªè©¢ç­–ç•¥    â”‚          â”‚
â”‚  â”‚  (Claude CLI)â”‚  â”‚  (AI Gateway)â”‚  â”‚  (Polling)   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                 â”‚                 â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                           â”‚                                     â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                  â”‚   çµ±ä¸€é…ç½®å±¤    â”‚                            â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                           â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚                 â”‚                 â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   æŠ€èƒ½ç³»çµ±   â”‚  â”‚   MCP æ•´åˆ  â”‚  â”‚  è¨˜æ†¶ç³»çµ±   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ç¬¬ä¸€éƒ¨åˆ†ï¼šOpenCode è¦ç¯„

## 1.1 é…ç½®æª”çµæ§‹

### settings.json å®Œæ•´åƒæ•¸

| åƒæ•¸è·¯å¾‘ | é¡å‹ | èªªæ˜ | é è¨­å€¼ |
|----------|------|------|--------|
| `permissions.allow` | array | å…è¨±çš„å·¥å…·å’Œæ“ä½œ | `[]` |
| `permissions.additionalDirectories` | array | é¡å¤–å…è¨±çš„ç›®éŒ„ | `[]` |
| `hooks.SessionStart` | array | æœƒè©±é–‹å§‹æ™‚åŸ·è¡Œ | `[]` |
| `hooks.PreToolUse` | array | å·¥å…·ä½¿ç”¨å‰åŸ·è¡Œ | `[]` |
| `hooks.PostToolUse` | array | å·¥å…·ä½¿ç”¨å¾ŒåŸ·è¡Œ | `[]` |
| `mcpServers` | object | MCP ä¼ºæœå™¨é…ç½® | `{}` |
| `enabledPlugins` | object | å•Ÿç”¨çš„æ’ä»¶ | `{}` |

### é…ç½®ç¯„ä¾‹

```json
{
  "permissions": {
    "allow": [
      "Bash(git:*)",
      "Bash(npm:*)",
      "Read(//Users/hung/**)",
      "mcp__playwright"
    ],
    "additionalDirectories": [
      "/Users/hung/Documents/æ€ç¶­ç†”çˆ",
      "/tmp"
    ]
  },
  "hooks": {
    "SessionStart": [{
      "matcher": "",
      "hooks": [{
        "type": "command",
        "command": "bash ~/.claude/hooks/startup.sh"
      }]
    }],
    "PostToolUse": [{
      "matcher": "",
      "hooks": [{
        "type": "command",
        "command": "python3 ~/.claude/hooks/ingest.py",
        "timeout": 5000
      }]
    }]
  },
  "mcpServers": {
    "brave-search": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-server-brave-search"],
      "env": {
        "BRAVE_API_KEY": "${BRAVE_API_KEY}"
      }
    }
  }
}
```

---

## 1.2 ä»£ç†ç³»çµ±ï¼ˆAgentsï¼‰

### ä»£ç†é¡å‹

| ä»£ç† | æˆæœ¬ | ç”¨é€” | ä½¿ç”¨æ™‚æ©Ÿ |
|------|------|------|----------|
| `explore` | ğŸŸ¢ ä½ | ç¨‹å¼ç¢¼æ¢ç´¢ | æ‰¾æª”æ¡ˆã€æœé—œéµå­— |
| `librarian` | ğŸŸ¢ ä½ | æ–‡æª”æœå°‹ | æŸ¥å¤–éƒ¨æ–‡æª”ã€OSS |
| `oracle` | ğŸ”´ é«˜ | æ·±åº¦æ¨ç† | è¤‡é›œæ¶æ§‹ã€ç–‘é›£é›œç—‡ |
| `metis` | ğŸ”´ é«˜ | å‰ç½®åˆ†æ | éœ€æ±‚æ¾„æ¸…ã€éš±è—æ„åœ– |
| `momus` | ğŸ”´ é«˜ | è¨ˆç•«å¯©æŸ¥ | é©—è­‰è¨ˆç•«å®Œæ•´æ€§ |

### delegate_task åƒæ•¸

```python
delegate_task(
    # å¿…å¡«åƒæ•¸
    description: str,        # 3-5 å­—ä»»å‹™æè¿°
    prompt: str,             # è©³ç´°ä»»å‹™èªªæ˜ï¼ˆè‹±æ–‡ï¼‰
    load_skills: list,       # è¼‰å…¥çš„æŠ€èƒ½åˆ—è¡¨
    run_in_background: bool, # æ˜¯å¦èƒŒæ™¯åŸ·è¡Œ
    
    # äºŒé¸ä¸€
    category: str,           # ä»»å‹™é¡åˆ¥
    subagent_type: str,      # ç›´æ¥æŒ‡å®šä»£ç†
    
    # é¸å¡«
    session_id: str,         # ç¹¼çºŒå…ˆå‰æœƒè©±
    command: str             # è§¸ç™¼æŒ‡ä»¤
)
```

### ä»»å‹™é¡åˆ¥

| é¡åˆ¥ | ç”¨é€” | æ¨¡å‹å„ªåŒ– |
|------|------|----------|
| `visual-engineering` | å‰ç«¯/UI/UX | è¦–è¦ºè¨­è¨ˆ |
| `ultrabrain` | é«˜é›£åº¦é‚è¼¯ | æ·±åº¦æ¨ç† |
| `deep` | è¤‡é›œå•é¡Œç ”ç©¶ | è‡ªä¸»æ¢ç´¢ |
| `artistry` | å‰µæ„è§£æ±ºæ–¹æ¡ˆ | éå‚³çµ± |
| `quick` | ç°¡å–®ä»»å‹™ | å¿«é€Ÿ |
| `writing` | æ–‡æª”æ’°å¯« | å¯«ä½œ |

---

## 1.3 æŠ€èƒ½ç³»çµ±ï¼ˆSkillsï¼‰

### skill.md æ ¼å¼è¦ç¯„

```markdown
---
name: skill-name
description: "æŠ€èƒ½ç°¡è¿°ï¼ˆé¡¯ç¤ºåœ¨åˆ—è¡¨ï¼‰"
metadata:
  {
    "version": "1.0",
    "tags": ["tag1", "tag2"]
  }
---

# æŠ€èƒ½æ¨™é¡Œ

> **ä¸­æ–‡å‚™è¨»**ï¼šæŠ€èƒ½ç”¨é€”èªªæ˜
> **ä½¿ç”¨æ–¹å¼**ï¼š`/skill skill-name`

## åŠŸèƒ½èªªæ˜
...

## ä½¿ç”¨ç¯„ä¾‹
...
```

### æŠ€èƒ½ç›®éŒ„çµæ§‹

```
~/.claude/skills/
â””â”€â”€ my-skill/
    â”œâ”€â”€ skill.md          # æŠ€èƒ½å®šç¾©ï¼ˆå¿…è¦ï¼‰
    â”œâ”€â”€ mcp/              # MCP å·¥å…·ï¼ˆé¸ç”¨ï¼‰
    â”‚   â””â”€â”€ tools.py
    â””â”€â”€ docs/             # çŸ¥è­˜æ–‡æª”ï¼ˆé¸ç”¨ï¼‰
```

---

# ç¬¬äºŒéƒ¨åˆ†ï¼šOpenClaw è¦ç¯„

## 2.1 é…ç½®æª”ï¼ˆopenclaw.jsonï¼‰

### å®Œæ•´åƒæ•¸èªªæ˜

```json
{
  "gateway": {
    "port": 18789,           // ç¶²é—œç«¯å£
    "host": "0.0.0.0",       // ç›£è½åœ°å€
    "cors": {
      "enabled": true,
      "origins": ["*"]
    }
  },
  
  "models": {
    "default": "claude-sonnet-4-20250514",
    "providers": {
      "anthropic": {
        "enabled": true,
        "apiKey": "${ANTHROPIC_API_KEY}",
        "models": ["claude-sonnet-4-20250514", "claude-opus-4-20250514"]
      },
      "openai": {
        "enabled": true,
        "apiKey": "${OPENAI_API_KEY}",
        "models": ["gpt-4o", "gpt-4o-mini"]
      },
      "google": {
        "enabled": true,
        "apiKey": "${GOOGLE_API_KEY}",
        "models": ["gemini-2.0-flash", "gemini-2.0-pro"]
      },
      "openrouter": {
        "enabled": false,
        "apiKey": "${OPENROUTER_API_KEY}",
        "models": ["auto"]
      }
    },
    "routing": {
      "strategy": "fallback",  // fallback | load-balance | cost-optimize | task-route
      "fallbackOrder": ["anthropic", "openai", "google"]
    }
  },
  
  "agents": {
    "defaults": {
      "sandbox": {
        "mode": "none"  // none | restricted | full
      },
      "tools": {
        "allowAll": true,
        "autoApprove": ["bash", "read", "write", "mcp_*"]
      }
    }
  },
  
  "memory": {
    "enabled": true,
    "vectorDb": {
      "type": "qdrant",
      "url": "http://localhost:6333"
    }
  },
  
  "security": {
    "rateLimit": {
      "enabled": true,
      "maxRequests": 100,
      "windowMs": 60000
    }
  }
}
```

---

## 2.2 è¶…ç´šæŠ€èƒ½æ¡†æ¶

### äº”å¤§è¶…ç´šæŠ€èƒ½

| æŠ€èƒ½ | ç”¨é€” | Token ç¯€çœ | åƒæ•¸ |
|------|------|-----------|------|
| `auto-research` | è‡ªå‹•æœç´¢æ•´ç† | ~60% | `--topic`, `--depth` |
| `parallel-execute` | ä¸¦è¡ŒåŸ·è¡Œ | ~70% | `--tasks`, `--workers` |
| `token-optimizer` | ä¸Šä¸‹æ–‡å£“ç¸® | ~50% | `--threshold`, `--strategy` |
| `smart-polling` | æ™ºèƒ½è¼ªè©¢ | ~40% | `--models`, `--consensus` |
| `memory-sync` | è¨˜æ†¶åŒæ­¥ | ~80% | `--nodes`, `--scope` |

### å•Ÿç”¨é…ç½®

```json
{
  "agents": {
    "defaults": {
      "sandbox": { "mode": "none" },
      "tools": { "allowAll": true, "autoApprove": ["*"] },
      "skills": {
        "paths": ["~/.claude/skills/openclaw-super-skills"]
      }
    }
  }
}
```

### ä½¿ç”¨æ–¹å¼

```bash
# å–®ç¨ä½¿ç”¨
/super auto-research "AI ä»£ç†æ¡†æ¶ 2026"

# çµ„åˆä½¿ç”¨
/super parallel-execute --tasks="task1.md,task2.md"

# å¸¶åƒæ•¸
/super token-optimizer --threshold=80000 --strategy=aggressive
```

---

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¼ªè©¢æœ€ä½³å¯¦è¸

## 3.1 æ™ºèƒ½è¼ªè©¢ç­–ç•¥

### ç­–ç•¥ä¸€ï¼šRound-Robin è¼ªæ›¿

```python
class RoundRobinRouter:
    def __init__(self, api_keys: list):
        self.keys = api_keys
        self.index = 0
    
    def get_next_key(self) -> str:
        key = self.keys[self.index]
        self.index = (self.index + 1) % len(self.keys)
        return key
```

### ç­–ç•¥äºŒï¼šRate-Limit æ„ŸçŸ¥

```python
class RateLimitAwareRouter:
    def __init__(self, api_keys: list):
        self.keys = {k: {"remaining": 100, "reset_at": 0} for k in api_keys}
    
    def get_best_key(self) -> str:
        now = time.time()
        available = [
            (k, v["remaining"]) 
            for k, v in self.keys.items() 
            if v["remaining"] > 0 or now > v["reset_at"]
        ]
        if not available:
            raise Exception("All keys exhausted")
        return max(available, key=lambda x: x[1])[0]
    
    def update_limits(self, key: str, remaining: int, reset_at: int):
        self.keys[key]["remaining"] = remaining
        self.keys[key]["reset_at"] = reset_at
```

### ç­–ç•¥ä¸‰ï¼šFallback éˆ

```python
class FallbackRouter:
    def __init__(self, providers: list):
        self.providers = providers  # æŒ‰å„ªå…ˆç´šæ’åº
    
    async def execute(self, request) -> Response:
        errors = []
        for provider in self.providers:
            try:
                return await provider.call(request)
            except Exception as e:
                errors.append((provider.name, str(e)))
                continue
        raise Exception(f"All providers failed: {errors}")
```

---

## 3.2 æ‰¹æ¬¡è™•ç†æ¡†æ¶

### æ ¸å¿ƒé¡åˆ¥

```python
class BatchProcessor:
    def __init__(self, batch_size: int = 100):
        self.batch_size = batch_size
        self.total_processed = 0
        self.errors = []
    
    def load_batches(self, data: list):
        for i in range(0, len(data), self.batch_size):
            yield data[i:i + self.batch_size]
    
    def track_progress(self, processed: int, success: int, failed: int):
        self.total_processed += processed
```

### 7 ç¨®è™•ç†æ¨¡å¼

| æ¨¡å¼ | ç”¨é€” | æ‰¹æ¬¡å¤§å°å»ºè­° |
|------|------|-------------|
| æª”æ¡ˆè™•ç† | æ‰¹é‡è™•ç†æª”æ¡ˆ | 50 |
| è³‡æ–™åº«æ“ä½œ | æ‰¹é‡æ›´æ–° DB | 100 |
| ç´¢å¼•åˆä½µ | åˆä½µ JSON ç´¢å¼• | 7 |
| æ¨¡ç³ŠåŒ¹é… | æ‰¹é‡æ¯”å° | 100 |
| è³‡æ–™è¼‰å…¥ | åˆ†æ‰¹è¼‰å…¥ CSV | 1000 |
| è¨˜æ†¶é«”å„ªåŒ– | å¤§æª”æ¡ˆè™•ç† | 100 |
| ä¸¦è¡Œè™•ç† | å¤šé€²ç¨‹åŠ é€Ÿ | 100 |

### éŒ¯èª¤è™•ç†ç­–ç•¥

| ç­–ç•¥ | èªªæ˜ | é©ç”¨å ´æ™¯ |
|------|------|----------|
| ç¹¼çºŒè™•ç† | è¨˜éŒ„éŒ¯èª¤å¾Œç¹¼çºŒ | å®¹éŒ¯æ€§é«˜ |
| é‡è©¦æ©Ÿåˆ¶ | å¤±æ•—é‡è©¦ N æ¬¡ | ç¶²è·¯ä¸ç©© |
| æª¢æŸ¥é» | æ”¯æ´æ–·é»çºŒå‚³ | é•·æ™‚é–“ä»»å‹™ |

---

# ç¬¬å››éƒ¨åˆ†ï¼šæ•´åˆåƒæ•¸é€ŸæŸ¥

## 4.1 ç’°å¢ƒè®Šæ•¸

```bash
# API Keys
export ANTHROPIC_API_KEY="sk-ant-..."
export OPENAI_API_KEY="sk-..."
export GOOGLE_API_KEY="AIza..."
export OPENROUTER_API_KEY="sk-or-..."
export BRAVE_API_KEY="BSA..."

# OpenClaw é…ç½®
export OPENCLAW_SANDBOX=off
export OPENCLAW_AUTO_APPROVE=true
export OPENCLAW_SUPER_SKILLS=true
export OPENCLAW_TOKEN_BUDGET=100000

# Soul System
export SOUL_API_URL="http://localhost:8531"
export OPENCLAW_FORGE_PATH="~/Documents/æ€ç¶­ç†”çˆ"
```

## 4.2 å¸¸ç”¨æŒ‡ä»¤

| æŒ‡ä»¤ | ç”¨é€” |
|------|------|
| `/skill skill-name` | è¼‰å…¥æŠ€èƒ½ |
| `/model model-name` | åˆ‡æ›æ¨¡å‹ |
| `/super skill-name` | åŸ·è¡Œè¶…ç´šæŠ€èƒ½ |
| `delegate_task(...)` | å§”æ´¾ä»»å‹™ |
| `background_output(task_id)` | å–å¾—èƒŒæ™¯ä»»å‹™çµæœ |

## 4.3 æª”æ¡ˆè·¯å¾‘

| è·¯å¾‘ | ç”¨é€” |
|------|------|
| `~/.claude/settings.json` | OpenCode è¨­å®š |
| `~/.claude/CLAUDE.md` | å…¨å±€äººæ ¼è¨­å®š |
| `~/.claude/skills/` | æŠ€èƒ½ç›®éŒ„ |
| `~/.openclaw/openclaw.json` | OpenClaw è¨­å®š |
| `~/.openclaw/SOUL.md` | AI äººæ ¼ |
| `~/.openclaw/MEMORY.md` | é•·æœŸè¨˜æ†¶ |
| `~/Documents/æ€ç¶­ç†”çˆ/` | Soul System |

---

# ç¬¬äº”éƒ¨åˆ†ï¼šè¨è«–ç¸½çµ

## è¨è«–ä¸€ï¼šé…ç½®æœ€ä½³å¯¦è¸

**çµè«–**ï¼š
1. ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ç®¡ç†æ•æ„Ÿè³‡è¨Š
2. æŠ€èƒ½æŒ‰é ˜åŸŸåˆ†é¡å­˜æ”¾
3. Hooks ç”¨æ–¼è‡ªå‹•åŒ–æµç¨‹

## è¨è«–äºŒï¼šä»£ç†é¸æ“‡ç­–ç•¥

**çµè«–**ï¼š
1. ç°¡å–®ä»»å‹™ â†’ explore/librarianï¼ˆä½æˆæœ¬ï¼‰
2. è¤‡é›œä»»å‹™ â†’ oracle/metisï¼ˆé«˜å“è³ªï¼‰
3. ä¸¦è¡Œæ¢ç´¢ â†’ å¤šå€‹ explore èƒŒæ™¯åŸ·è¡Œ

## è¨è«–ä¸‰ï¼šè¼ªè©¢æ•ˆç‡å„ªåŒ–

**çµè«–**ï¼š
1. Round-Robin é©åˆå‡å‹»è² è¼‰
2. Rate-Limit æ„ŸçŸ¥é©åˆé«˜ä½µç™¼
3. Fallback éˆç¢ºä¿å¯ç”¨æ€§

## è¨è«–å››ï¼šæ‰¹æ¬¡è™•ç†è¦ç¯„

**çµè«–**ï¼š
1. æ‰¹æ¬¡å¤§å°ä¾è¨˜æ†¶é«”èª¿æ•´
2. ä½¿ç”¨äº‹å‹™è™•ç†è³‡æ–™åº«æ“ä½œ
3. å¯¦ä½œæª¢æŸ¥é»æ”¯æ´æ–·é»çºŒå‚³

## è¨è«–äº”ï¼šæ•´åˆæ¶æ§‹

**çµè«–**ï¼š
1. OpenCode è² è²¬ CLI äº’å‹•
2. OpenClaw è² è²¬å¤šæ¨¡å‹ç¶²é—œ
3. Soul System è² è²¬è¨˜æ†¶å‘é‡åŒ–
4. ä¸‰è€…é€é MCP å”è­°æ•´åˆ

---

*æ–‡æª”ç‰ˆæœ¬ï¼š1.0*
*è³‡æ–™ä¾†æºï¼š3x3 æ‰¹æ¬¡æœå°‹ + 5 å›è¨è«–æ•´ç†*
*æœ€å¾Œæ›´æ–°ï¼š2026-02-04*
